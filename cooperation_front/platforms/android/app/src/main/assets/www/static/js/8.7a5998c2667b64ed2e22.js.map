{"version":3,"sources":["webpack:///src/view/LoginConfirm.vue","webpack:///./src/view/LoginConfirm.vue?68e2","webpack:///./src/view/LoginConfirm.vue"],"names":["LoginConfirm","data","session","qqInfo","email_add","flag","check_code","real_check_code","access_token","this","$route","query","userId","methods","checkRegister","_this","Object","helper","filter","then","res","console","log","undefined","loginData","_id","nickname","$router","push","path","getQQInfo","_this2","sendEmail","_this3","email","confirm","_this4","$message","error","registerData","avatar","figureurl_qq","sex","pet","score","birthday","desc","code","message","type","mounted","view_LoginConfirm","render","_vm","_h","$createElement","_c","_self","staticStyle","background-color","height","attrs","span","to","staticClass","font-size","color","_v","margin-top","src","size","_s","text-align","margin","display","align-items","placeholder","model","value","callback","$$v","expression","plain","round","on","click","_e","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/8.7a5998c2667b64ed2e22.js","sourcesContent":["<template>\n  <el-container style=\"background-color: #E6EEFF\">\n    <el-header style=\"height: 160px\">\n      <el-row>\n        <el-col :span=\"3\">\n          <router-link to=\"/\">\n            <i class=\"el-icon-arrow-left\" style=\"font-size: 25px; color: #B8CDE6\"></i>\n          </router-link>\n        </el-col>\n      </el-row>\n      <h1 style=\"font-size: 40px;color:darkslategray; margin-top: 0px\">欢迎来到cornerstone</h1>\n    </el-header>\n    <el-main style=\"height: 500px\">\n\n      <div class=\"big-box\" style=\"background-color: #B8CDE6; color: darkslategray\">\n        <el-row>\n          <h1>完善您的个人信息</h1>\n        </el-row>\n        <el-row>\n          <el-avatar :src=\"qqInfo.data.figureurl_qq\" :size=\"80\"></el-avatar>\n        </el-row>\n        <el-row>\n          <h3> {{qqInfo.data.nickname}}，欢迎您！</h3>\n        </el-row>\n\n\n\n      </div>\n      <br>\n      <div v-if=\"flag==0\">\n        <el-row>\n          <el-col style=\"text-align: left\"><h4 style=\"margin: 5px;\">绑定您的邮箱地址:</h4></el-col>\n        </el-row>\n        <el-row style=\"display: flex; align-items: center; \">\n          <el-col :span=\"16\">\n            <el-input v-model=\"email_add\" size=\"medium\" placeholder=\"请输入您的邮箱\"></el-input>\n          </el-col>\n          <el-col :span=\"4\"> <el-button type=\"info\" plain round @click=\"sendEmail\">获取验证码</el-button></el-col>\n        </el-row>\n\n      </div>\n      <div v-if=\"flag==1\">\n        <el-row>\n          <el-col style=\"text-align: left\"><h4 style=\"margin: 5px;\">{{email_add}}:</h4></el-col>\n        </el-row>\n        <el-row style=\"display: flex; align-items: center\">\n          <el-col :span=\"12\"><h4>请输入验证码:</h4></el-col>\n          <el-col :span=\"12\">\n            <el-input v-model=\"check_code\" size=\"medium\" placeholder=\"验证码\"></el-input>\n          </el-col>\n        </el-row>\n        <el-button type=\"info\" plain round @click=\"confirm\">确认登录</el-button>\n      </div>\n\n    </el-main>\n\n\n\n    <div class=\"myfooter\">\n\n        <p style=\"color: grey\">了解更多</p>\n\n    </div>\n  </el-container>\n\n</template>\n\n\n\n<script>\n\n    import {Post,Get} from '../model/helper.js'\n\n    export default {\n\n        data() {\n            return {\n                session:\"\",\n                qqInfo:[],\n                email_add:\"\",\n                flag: 0,\n                check_code:\"\",\n                real_check_code:\"\",\n                access_token:this.$route.query.access_token,\n                userId:this.$route.query.userId,\n\n            }\n        },\n\n        methods:{\n            checkRegister(){\n                Post('/api/user/find', {filter:{\"access_token\": this.access_token}}).then(data=>{\n                    let res = data.data[0]\n                    console.log(data)\n                    if(res!=undefined){\n                        let loginData = {\n                            \"_id\": res._id,\n                            \"nickname\": res.nickname\n                        }\n\n                        Post('/api/user/login',loginData).then(data=>{\n                            this.$router.push({path:'/square'})\n                        })\n\n                    }\n                })\n            },\n\n\n            getQQInfo(){\n                Post('/api/user/auth', {access_token: this.access_token, userId: this.userId}).then(data=>{\n                    this.qqInfo = data\n                    console.log(data)\n                })\n            },\n\n            sendEmail(){\n                let data = {\"email\": this.email_add, \"nickname\":this.qqInfo.data.nickname}\n\n                Post('/api/user/email', data).then(data =>{\n                    console.log(data)\n                    this.real_check_code = data.data\n\n                })\n                this.flag=1\n            },\n\n            confirm(){\n                if(this.check_code != this.real_check_code){\n                    this.$message.error('验证码错误！');\n\n                }\n                else{\n                    let registerData = {\n                        \"email\": this.email_add,\n                        \"access_token\":\"F6D42A2437E562738B44459B47334D21\",\n                        \"nickname\":this.qqInfo.data.nickname,\n                        \"avatar\": this.qqInfo.data.figureurl_qq,\n                        \"sex\": this.qqInfo.data.sex,\n                        \"pet\": 0,\n                        \"score\": 0,\n                        'birthday': \"\",\n                        'desc':''\n                    }\n                    Post(\"/api/user/register\",registerData).then(data=>{\n                        console.log(data)\n                        if(data.code!=0){\n                            this.$message({\n                                'message': data.error,\n                                'type': \"warning\"\n                            })\n                            return\n                        }\n                        let loginData = {\n                            \"_id\": this.email_add,\n                            \"nickname\": this.qqInfo.data.nickname,\n                        }\n                        Post('/api/user/login',loginData).then(data=>{\n                            this.$router.push({path:'/square'})\n                        })\n                    })\n                }\n\n\n\n            }\n        },\n\n\n        mounted() {\n            console.log(this.$route.query)\n            this.checkRegister()\n            this.getQQInfo()\n        }\n    }\n</script>\n\n<style>\n  .circle_box{\n    height: 80px;\n    width: 80px;\n    border-radius:50%;\n    -webkit-border-radius:50%;\n    -moz-border-radius:50%;\n    margin-top: 15px;\n  }\n  .myfooter{\n    position: fixed;\n    bottom: 0px;\n    z-index: 9999;\n    width: 100%;\n    background-color: #E6EEFF;\n\n  }\n  .big-box{\n    border: 2px solid #C1D3E8;\n\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/view/LoginConfirm.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-container',{staticStyle:{\"background-color\":\"#E6EEFF\"}},[_c('el-header',{staticStyle:{\"height\":\"160px\"}},[_c('el-row',[_c('el-col',{attrs:{\"span\":3}},[_c('router-link',{attrs:{\"to\":\"/\"}},[_c('i',{staticClass:\"el-icon-arrow-left\",staticStyle:{\"font-size\":\"25px\",\"color\":\"#B8CDE6\"}})])],1)],1),_vm._v(\" \"),_c('h1',{staticStyle:{\"font-size\":\"40px\",\"color\":\"darkslategray\",\"margin-top\":\"0px\"}},[_vm._v(\"欢迎来到cornerstone\")])],1),_vm._v(\" \"),_c('el-main',{staticStyle:{\"height\":\"500px\"}},[_c('div',{staticClass:\"big-box\",staticStyle:{\"background-color\":\"#B8CDE6\",\"color\":\"darkslategray\"}},[_c('el-row',[_c('h1',[_vm._v(\"完善您的个人信息\")])]),_vm._v(\" \"),_c('el-row',[_c('el-avatar',{attrs:{\"src\":_vm.qqInfo.data.figureurl_qq,\"size\":80}})],1),_vm._v(\" \"),_c('el-row',[_c('h3',[_vm._v(\" \"+_vm._s(_vm.qqInfo.data.nickname)+\"，欢迎您！\")])])],1),_vm._v(\" \"),_c('br'),_vm._v(\" \"),(_vm.flag==0)?_c('div',[_c('el-row',[_c('el-col',{staticStyle:{\"text-align\":\"left\"}},[_c('h4',{staticStyle:{\"margin\":\"5px\"}},[_vm._v(\"绑定您的邮箱地址:\")])])],1),_vm._v(\" \"),_c('el-row',{staticStyle:{\"display\":\"flex\",\"align-items\":\"center\"}},[_c('el-col',{attrs:{\"span\":16}},[_c('el-input',{attrs:{\"size\":\"medium\",\"placeholder\":\"请输入您的邮箱\"},model:{value:(_vm.email_add),callback:function ($$v) {_vm.email_add=$$v},expression:\"email_add\"}})],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":4}},[_c('el-button',{attrs:{\"type\":\"info\",\"plain\":\"\",\"round\":\"\"},on:{\"click\":_vm.sendEmail}},[_vm._v(\"获取验证码\")])],1)],1)],1):_vm._e(),_vm._v(\" \"),(_vm.flag==1)?_c('div',[_c('el-row',[_c('el-col',{staticStyle:{\"text-align\":\"left\"}},[_c('h4',{staticStyle:{\"margin\":\"5px\"}},[_vm._v(_vm._s(_vm.email_add)+\":\")])])],1),_vm._v(\" \"),_c('el-row',{staticStyle:{\"display\":\"flex\",\"align-items\":\"center\"}},[_c('el-col',{attrs:{\"span\":12}},[_c('h4',[_vm._v(\"请输入验证码:\")])]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":12}},[_c('el-input',{attrs:{\"size\":\"medium\",\"placeholder\":\"验证码\"},model:{value:(_vm.check_code),callback:function ($$v) {_vm.check_code=$$v},expression:\"check_code\"}})],1)],1),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"info\",\"plain\":\"\",\"round\":\"\"},on:{\"click\":_vm.confirm}},[_vm._v(\"确认登录\")])],1):_vm._e()]),_vm._v(\" \"),_c('div',{staticClass:\"myfooter\"},[_c('p',{staticStyle:{\"color\":\"grey\"}},[_vm._v(\"了解更多\")])])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-ca06c1fc\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/view/LoginConfirm.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-ca06c1fc\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./LoginConfirm.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./LoginConfirm.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./LoginConfirm.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-ca06c1fc\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./LoginConfirm.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/view/LoginConfirm.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}