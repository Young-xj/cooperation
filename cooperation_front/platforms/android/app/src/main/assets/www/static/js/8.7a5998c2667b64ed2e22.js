webpackJsonp([8],{NrSc:function(e,t){},zgXW:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("DZOf"),n={data:function(){return{session:"",qqInfo:[],email_add:"",flag:0,check_code:"",real_check_code:"",access_token:this.$route.query.access_token,userId:this.$route.query.userId}},methods:{checkRegister:function(){var e=this;Object(i.b)("/api/user/find",{filter:{access_token:this.access_token}}).then(function(t){var a=t.data[0];if(console.log(t),void 0!=a){var n={_id:a._id,nickname:a.nickname};Object(i.b)("/api/user/login",n).then(function(t){e.$router.push({path:"/square"})})}})},getQQInfo:function(){var e=this;Object(i.b)("/api/user/auth",{access_token:this.access_token,userId:this.userId}).then(function(t){e.qqInfo=t,console.log(t)})},sendEmail:function(){var e=this,t={email:this.email_add,nickname:this.qqInfo.data.nickname};Object(i.b)("/api/user/email",t).then(function(t){console.log(t),e.real_check_code=t.data}),this.flag=1},confirm:function(){var e=this;if(this.check_code!=this.real_check_code)this.$message.error("验证码错误！");else{var t={email:this.email_add,access_token:"F6D42A2437E562738B44459B47334D21",nickname:this.qqInfo.data.nickname,avatar:this.qqInfo.data.figureurl_qq,sex:this.qqInfo.data.sex,pet:0,score:0,birthday:"",desc:""};Object(i.b)("/api/user/register",t).then(function(t){if(console.log(t),0==t.code){var a={_id:e.email_add,nickname:e.qqInfo.data.nickname};Object(i.b)("/api/user/login",a).then(function(t){e.$router.push({path:"/square"})})}else e.$message({message:t.error,type:"warning"})})}}},mounted:function(){console.log(this.$route.query),this.checkRegister(),this.getQQInfo()}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticStyle:{"background-color":"#E6EEFF"}},[a("el-header",{staticStyle:{height:"160px"}},[a("el-row",[a("el-col",{attrs:{span:3}},[a("router-link",{attrs:{to:"/"}},[a("i",{staticClass:"el-icon-arrow-left",staticStyle:{"font-size":"25px",color:"#B8CDE6"}})])],1)],1),e._v(" "),a("h1",{staticStyle:{"font-size":"40px",color:"darkslategray","margin-top":"0px"}},[e._v("欢迎来到cornerstone")])],1),e._v(" "),a("el-main",{staticStyle:{height:"500px"}},[a("div",{staticClass:"big-box",staticStyle:{"background-color":"#B8CDE6",color:"darkslategray"}},[a("el-row",[a("h1",[e._v("完善您的个人信息")])]),e._v(" "),a("el-row",[a("el-avatar",{attrs:{src:e.qqInfo.data.figureurl_qq,size:80}})],1),e._v(" "),a("el-row",[a("h3",[e._v(" "+e._s(e.qqInfo.data.nickname)+"，欢迎您！")])])],1),e._v(" "),a("br"),e._v(" "),0==e.flag?a("div",[a("el-row",[a("el-col",{staticStyle:{"text-align":"left"}},[a("h4",{staticStyle:{margin:"5px"}},[e._v("绑定您的邮箱地址:")])])],1),e._v(" "),a("el-row",{staticStyle:{display:"flex","align-items":"center"}},[a("el-col",{attrs:{span:16}},[a("el-input",{attrs:{size:"medium",placeholder:"请输入您的邮箱"},model:{value:e.email_add,callback:function(t){e.email_add=t},expression:"email_add"}})],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"info",plain:"",round:""},on:{click:e.sendEmail}},[e._v("获取验证码")])],1)],1)],1):e._e(),e._v(" "),1==e.flag?a("div",[a("el-row",[a("el-col",{staticStyle:{"text-align":"left"}},[a("h4",{staticStyle:{margin:"5px"}},[e._v(e._s(e.email_add)+":")])])],1),e._v(" "),a("el-row",{staticStyle:{display:"flex","align-items":"center"}},[a("el-col",{attrs:{span:12}},[a("h4",[e._v("请输入验证码:")])]),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{size:"medium",placeholder:"验证码"},model:{value:e.check_code,callback:function(t){e.check_code=t},expression:"check_code"}})],1)],1),e._v(" "),a("el-button",{attrs:{type:"info",plain:"",round:""},on:{click:e.confirm}},[e._v("确认登录")])],1):e._e()]),e._v(" "),a("div",{staticClass:"myfooter"},[a("p",{staticStyle:{color:"grey"}},[e._v("了解更多")])])],1)},staticRenderFns:[]};var c=a("VU/8")(n,s,!1,function(e){a("NrSc")},null,null);t.default=c.exports}});
//# sourceMappingURL=8.7a5998c2667b64ed2e22.js.map