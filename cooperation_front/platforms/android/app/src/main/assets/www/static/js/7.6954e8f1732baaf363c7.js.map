{"version":3,"sources":["webpack:///src/view/Task/TaskDetail.vue","webpack:///./src/view/Task/TaskDetail.vue?2fae","webpack:///./src/view/Task/TaskDetail.vue"],"names":["TaskDetail","components","Footer","data","tid","this","$route","params","test_1","test_1_default","a","search","activeName","score","task_time","whole","current","checked","count","taskInfo","user","diff","uid","friend_uid","button_name","myfinish","methods","handleClick","tab","console","log","name","getTask","_this","asyncToGenerator_default","regenerator_default","mark","_callee","date","date_now","length","finish","wrap","_context","prev","next","Object","model_user","sent","code","alert","$router","push","path","helper","filter","_id","uid1","Date","getFullYear","getMonth","getDate","dateDiff","start","days","Math","abs","stop","sDate1","sDate2","oDate1","oDate2","aDate","split","parseInt","confirmFinish","_this2","then","$message","message","type","mounted","Task_TaskDetail","render","_vm","_h","$createElement","_c","_self","staticStyle","height","display","align-items","attrs","span","to","staticClass","font-size","color","_v","_s","desc","src","text-align","offset","margin","_l","tasks","value","key","background-color","on","click","pid","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/7.6954e8f1732baaf363c7.js","sourcesContent":["<template>\n  <el-container>\n    <el-header style=\"height:250px\">\n      <el-row style=\"display: flex;align-items: center\">\n        <el-col :span=\"3\">\n          <router-link to=\"/task\">\n            <i class=\"el-icon-arrow-left\" style=\"font-size: 25px; color: #B8CDE6\"></i>\n          </router-link>\n        </el-col>\n        <el-col :span=\"20\">\n          <h1>{{taskInfo.desc}}</h1>\n        </el-col>\n      </el-row>\n\n      <el-row>\n        <el-image :src=\"test_1\" style=\"height: 180px;\"></el-image>\n      </el-row>\n    </el-header>\n    <el-main>\n      <div class=\"big-box\">\n        <el-row style=\"text-align: left;\">\n          <el-col :span=\"12\" :offset=\"1\"><p>我的累计积分:{{taskInfo.score[uid]}}</p></el-col>\n          <el-col :span=\"10\"><p>每日完成得分: 5</p></el-col>\n        </el-row>\n        <el-row class=\"row-text-left\">\n          <el-col :span=\"12\" :offset=\"1\"><p>当前:{{current}}</p></el-col>\n          <el-col :span=\"10\"><p>总时间:{{taskInfo.days}}天</p></el-col>\n        </el-row>\n      </div>\n\n      <div style=\"margin: 30px\">\n\n        <h3 style=\"margin: 2px\">第{{diff}}日安排</h3>\n\n        <div v-for=\"(value, key) in taskInfo.tasks[diff-1]\" :key=\"key\">\n          <el-row class=\"row-text-left\">\n            <h4 style=\"margin: 5px\">{{key}}</h4>\n          </el-row>\n\n          <el-row class=\"row-text-left\">\n            <el-col :offset=\"1\">\n              {{value}}\n            </el-col>\n          </el-row>\n        </div>\n\n        <el-button style=\"background-color: #B8CDE6\" @click=\"confirmFinish\">{{button_name}}</el-button>\n        <br>\n        <br>\n        <br>\n        <el-row style=\"font-size: 13px\">\n          <el-col :span=\"10\">\n            <router-link class=\"route-link\" :to=\"{ name: 'plandetail', params: { pid: taskInfo.pid }}\">\n              关于此计划\n            </router-link>\n          </el-col>\n\n          <el-col :span=\"12\" :offset=\"2\">\n            {{myfinish}}\n          </el-col>\n        </el-row>\n      </div>\n\n\n    </el-main>\n\n\n    <Footer></Footer>\n  </el-container>\n\n</template>\n\n<script>\n    import Footer from \"../../components/Footer\";\n    import test_1 from \"../../assets/test_1.jpg\"\n    import {getUserInfo} from \"../../model/user\";\n    import {Post} from \"../../model/helper\";\n\n    export default{\n        components:{\n            Footer,\n        },\n        data(){\n            return {\n                tid: this.$route.params.tid,\n                test_1: test_1,\n                search: \"\",\n                activeName:\"今日未完成\",\n                score:[\"10\", \"10\"],\n                task_time:{'whole': 60, 'current': 15},\n                checked: false,\n                count: 0,\n                taskInfo:{},\n                user:{},\n                current:\"\",\n                diff: 0,\n                uid: \"\",\n                friend_uid: \"\",\n                button_name:\"确认对方已完成\",\n                myfinish:\"宁今日尚未完成\"\n            }\n        },\n\n        methods:{\n            handleClick(tab) {\n                console.log(tab.name);\n            },\n\n            async getTask(){\n                let user = await getUserInfo()\n                if(user.code != 0){\n                    alert(\"宁没有登录\")\n                    this.$router.push({path:'/'})\n                }\n                else {\n                    this.user = user.data\n\n                    let taskInfo = await Post('/api/task/find', {filter: {_id: this.tid}})\n\n                    this.taskInfo = taskInfo.data[0]\n\n                    if(user._id == this.taskInfo.uid1){ this.uid = 'uid1'; this.friend_uid='uid2'}\n                    else{this.uid='uid2'; this.friend_uid='uid1'}\n\n                    let date = new Date()\n                    let date_now = date.getFullYear()+'-'+ (date .getMonth()+1) + '-' + date.getDate()\n                    let diff = this.dateDiff(date_now, this.taskInfo.start)\n                    let length = this.taskInfo.days\n\n                    if(diff < 0){\n                        this.current = \"还有\" + Math.abs(diff) + \"天开始\"\n                        this.diff = 1\n                        this.button_name=\"尚未开始\"\n                    }\n                    else if (diff >= length){\n                        this.current = \"已结束\"\n                        this.diff = length-1\n                        this.button_name=\"已结束\"\n                    }\n                    else{\n                        this.current = diff + 1\n                        this.diff = diff + 1\n                        let finish = this.taskInfo.finish\n                        if(finish[this.friend_uid][diff-1]!=0){\n                            this.button_name=\"对方已完成\"\n                        }\n                        if(finish[this.uid][diff-1] != 0){\n                            this.myfinish=\"宁已完成\"\n                        }\n                    }\n                }\n            },\n\n            dateDiff(sDate1, sDate2) { //sDate1和sDate2是2019-3-12格式\n\n                let aDate, oDate1, oDate2, iDays\n                aDate = sDate1.split(\"-\")\n                oDate1 = new Date(aDate[1] + '-' + aDate[2] + '-' + aDate[0]) //转换为9-25-2017格式\n                aDate = sDate2.split(\"-\")\n                oDate2 = new Date(aDate[1] + '-' + aDate[2] + '-' + aDate[0])\n                iDays = parseInt((oDate1 - oDate2) / 1000 / 60 / 60 / 24) //把相差的毫秒数转换为天数\n                return iDays\n            },\n\n            confirmFinish(){\n                if(this.button_name==\"确认对方已完成\"){\n                    this.taskInfo.finish[this.friend_uid][this.diff-1] = 1\n                    this.taskInfo[this.friend_uid] += 5\n                    Post('/api/task/'+this.taskInfo._id+ '/update', this.taskInfo).then(data=>{\n                        console.log(data)\n                        this.button_name = \"对方已完成\"\n                    })\n                }\n                else{\n                    this.$message({\n                        'message': \"当前不可进行此操作！\",\n                        'type': \"warning\"\n                    })\n                }\n            }\n\n        },\n\n        mounted(){\n            this.getTask()\n        }\n    }\n\n</script>\n\n<style>\n  .long-button{\n    width: 100%;\n    background-color: #B8CDE6;\n    height: 50px;\n  }\n\n  .small-box-2{\n    background-color: #B8CDE6;\n    display: flex;\n    align-items: center;\n  }\n  .row-text-left{\n    text-align: left;\n    height: 40px;\n  }\n  .route-link {\n    text-decoration: none;\n    color: black;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/view/Task/TaskDetail.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-container',[_c('el-header',{staticStyle:{\"height\":\"250px\"}},[_c('el-row',{staticStyle:{\"display\":\"flex\",\"align-items\":\"center\"}},[_c('el-col',{attrs:{\"span\":3}},[_c('router-link',{attrs:{\"to\":\"/task\"}},[_c('i',{staticClass:\"el-icon-arrow-left\",staticStyle:{\"font-size\":\"25px\",\"color\":\"#B8CDE6\"}})])],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":20}},[_c('h1',[_vm._v(_vm._s(_vm.taskInfo.desc))])])],1),_vm._v(\" \"),_c('el-row',[_c('el-image',{staticStyle:{\"height\":\"180px\"},attrs:{\"src\":_vm.test_1}})],1)],1),_vm._v(\" \"),_c('el-main',[_c('div',{staticClass:\"big-box\"},[_c('el-row',{staticStyle:{\"text-align\":\"left\"}},[_c('el-col',{attrs:{\"span\":12,\"offset\":1}},[_c('p',[_vm._v(\"我的累计积分:\"+_vm._s(_vm.taskInfo.score[_vm.uid]))])]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":10}},[_c('p',[_vm._v(\"每日完成得分: 5\")])])],1),_vm._v(\" \"),_c('el-row',{staticClass:\"row-text-left\"},[_c('el-col',{attrs:{\"span\":12,\"offset\":1}},[_c('p',[_vm._v(\"当前:\"+_vm._s(_vm.current))])]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":10}},[_c('p',[_vm._v(\"总时间:\"+_vm._s(_vm.taskInfo.days)+\"天\")])])],1)],1),_vm._v(\" \"),_c('div',{staticStyle:{\"margin\":\"30px\"}},[_c('h3',{staticStyle:{\"margin\":\"2px\"}},[_vm._v(\"第\"+_vm._s(_vm.diff)+\"日安排\")]),_vm._v(\" \"),_vm._l((_vm.taskInfo.tasks[_vm.diff-1]),function(value,key){return _c('div',{key:key},[_c('el-row',{staticClass:\"row-text-left\"},[_c('h4',{staticStyle:{\"margin\":\"5px\"}},[_vm._v(_vm._s(key))])]),_vm._v(\" \"),_c('el-row',{staticClass:\"row-text-left\"},[_c('el-col',{attrs:{\"offset\":1}},[_vm._v(\"\\n            \"+_vm._s(value)+\"\\n          \")])],1)],1)}),_vm._v(\" \"),_c('el-button',{staticStyle:{\"background-color\":\"#B8CDE6\"},on:{\"click\":_vm.confirmFinish}},[_vm._v(_vm._s(_vm.button_name))]),_vm._v(\" \"),_c('br'),_vm._v(\" \"),_c('br'),_vm._v(\" \"),_c('br'),_vm._v(\" \"),_c('el-row',{staticStyle:{\"font-size\":\"13px\"}},[_c('el-col',{attrs:{\"span\":10}},[_c('router-link',{staticClass:\"route-link\",attrs:{\"to\":{ name: 'plandetail', params: { pid: _vm.taskInfo.pid }}}},[_vm._v(\"\\n            关于此计划\\n          \")])],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":12,\"offset\":2}},[_vm._v(\"\\n          \"+_vm._s(_vm.myfinish)+\"\\n        \")])],1)],2)]),_vm._v(\" \"),_c('Footer')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-cd03e0e4\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/view/Task/TaskDetail.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-cd03e0e4\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./TaskDetail.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./TaskDetail.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./TaskDetail.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-cd03e0e4\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./TaskDetail.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/view/Task/TaskDetail.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}